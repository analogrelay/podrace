name: NginxStatic

roles:
  server:
    image: 'nginx:1.15.8'
  client:
    image: williamyeh/wrk
    # Don't run wrk on startup, just idle waiting for a command
    command: [ "/bin/sh", "-c", "while true; do sleep 2; done" ]

warmup:
- role: client
  exec: [ "wrk", "-c", "10", "-d", "5s", "http://server/" ]

benchmark:
- role: client
  exec: [ "/bin/sh", "-c", "wrk -c 10 -d 5s http://server/ > client.wrk.log" ]